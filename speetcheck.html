<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeeTcheck Invulformulier - WARP Systems</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" xintegrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        :root {
            --warp-green: #43ab34;
            --warp-dark-gray: #333333; 
            --warp-medium-gray: #666666;
            --warp-light-gray-bg: #f8f8f8; 
            --warp-border-gray: #e0e0e0;
            --warp-header-text-on-green: #000000; 
            --warp-header-text-on-black: #e0e0e0;
            --warp-black-header-bg: #000000;
            --warp-white-border: #ffffff;
            --top-header-height: 60px;
            --bottom-header-height: 60px; 
            --total-header-height: calc(var(--top-header-height) + var(--bottom-header-height));
            --logo-width: 120px; 
            --header-padding-x: 2rem; 
            --logo-overlap: 10px; 
            --logo-total-height: calc(var(--bottom-header-height) + 2 * var(--logo-overlap));
            --form-warp-green: #43ab34; 
            --form-warp-light-green: #7BC96F; 
            --form-warp-dark-gray: #58595B; 
            --form-warp-light-gray: #D1D2D4; 
            --form-warp-dun: #333333; 
        }

        body {
            font-family: 'Poppins', sans-serif; 
            background-color: var(--warp-light-gray-bg); 
            color: var(--warp-dark-gray);
            margin: 0;
            padding-top: var(--total-header-height); 
        }

        header#warp-main-header {
            position: fixed; 
            top: 0;
            left: 0;
            right: 0;
            z-index: 100; 
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            background-color: white; 
        }
        header#warp-main-header .header-container { max-width: 1920px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; position: relative; height: 100%; box-sizing: border-box; }
        header#warp-main-header .top-header { background-color: var(--warp-black-header-bg); color: var(--warp-header-text-on-black); padding: 0.8rem 0; font-size: 0.8rem; min-height: var(--top-header-height); display:flex; align-items:center; }
        header#warp-main-header .top-header .header-container { padding: 0 var(--header-padding-x); }
        header#warp-main-header .top-header a { text-decoration: none; transition: color 0.2s ease, background-color 0.2s ease, opacity 0.2s ease; }
        header#warp-main-header .top-header a:not(.icon-placeholder-link):not(.offerte-button-top):hover { color: #ffffff; }
        header#warp-main-header .showroom-link { color: var(--warp-green) !important; display: flex; align-items: center; font-weight: 500; }
        header#warp-main-header .showroom-link span { color: var(--warp-green); margin-right: 0.3rem; font-weight: 500; }
        header#warp-main-header .showroom-link:hover { color: #3aa129 !important; }
        header#warp-main-header .top-header-right { display: flex; align-items: center; gap: 0.75rem; }
        header#warp-main-header .search-container input { background-color: var(--warp-black-header-bg); border: 2px solid var(--warp-white-border); color: var(--warp-white-border); padding: 0.3rem 0.5rem; padding-right: 2rem; border-radius: 8px; font-size: 0.8rem; min-height: 40px; box-sizing: border-box; height: 30px; }
        header#warp-main-header .search-container .search-icon { position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); color: var(--warp-white-border); cursor: pointer; }
        header#warp-main-header .icon-placeholder-link { background-color: var(--warp-green); color: var(--warp-header-text-on-green); display: inline-flex; align-items: center; justify-content: center; padding: 0.3rem 0.6rem; border-radius: 8px; font-size: 1.1rem; line-height: 1; min-width: 40px; height: 40px; box-sizing: border-box; text-decoration: none; }
        header#warp-main-header .icon-placeholder-link:hover { background-color: #5a9a3f; }
        header#warp-main-header .offerte-button-top { background-color: #ffffff; color: var(--warp-green); padding: 0.3rem 0.8rem; border-radius: 8px; font-weight: 600; font-size: 0.8rem; text-decoration: none; border: 1px solid #ffffff; display: inline-flex; align-items: center; height: 40px; box-sizing: border-box; }
        header#warp-main-header .offerte-button-top:hover { background-color: #f0f0f0; color: #3aa129; }
        header#warp-main-header .bottom-header { background-color: var(--warp-green); color: var(--warp-header-text-on-green); position: relative; height: var(--bottom-header-height); }
        header#warp-main-header .bottom-header .header-container { min-height: 0; height: 100%; padding-left: calc(var(--logo-width) + var(--header-padding-x) + 1rem); padding-right: var(--header-padding-x); width: 100%; }
        header#warp-main-header #logo-container { position: absolute; width: var(--logo-width); height: var(--logo-total-height); left: var(--header-padding-x); top: calc(var(--top-header-height) - var(--logo-overlap)); z-index: 55; display: flex; align-items: center; justify-content: center; }
        header#warp-main-header #logo-container img { display: block; height: auto; object-fit: contain; transform: scale(2); transform-origin: center; }
        header#warp-main-header nav.centered-nav { flex-grow: 1; text-align: center; box-sizing: border-box; }
        @media (max-width: 1024px) { header#warp-main-header nav.centered-nav { display: none; } header#warp-main-header .bottom-header .header-container { padding-left: var(--header-padding-x); padding-right: var(--header-padding-x); justify-content: flex-end; } }
        header#warp-main-header nav.centered-nav a { color: var(--warp-header-text-on-green); text-decoration: none; margin: 0 0.8rem; transition: opacity 0.2s ease-in-out; font-size: 1rem; display: inline-block; }
        header#warp-main-header nav.centered-nav a.main-link { font-weight: 700; }
        header#warp-main-header nav.centered-nav a.secondary-link { font-weight: 400; }
        header#warp-main-header nav.centered-nav a:hover { opacity: 0.7; }
        header#warp-main-header .hamburger-menu { display: none; align-self: center; }
        @media (max-width: 1024px) { header#warp-main-header .hamburger-menu { display: block; } }
        header#warp-main-header .hamburger-menu button { color: var(--warp-header-text-on-green); font-size: 1.5rem; background: none; border: none; cursor: pointer; }

        .speetcheck-form-page-content {
            padding: 2rem; /* Padding rondom de formuliercontainer */
        }
        
        #formElementContainer {
            max-width: 48rem; /* Tailwind's max-w-3xl; 48rem = 768px */
            margin-left: auto; 
            margin-right: auto; 
            background-color: white;
            padding: 1.5rem; /* p-6 */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-xl */
            font-family: 'Inter', sans-serif; 
        }
        @media (min-width: 640px) { /* sm: */
            #formElementContainer {
                padding: 2.5rem; /* sm:p-10 */
            }
        }

        .section-title { color: var(--form-warp-green); border-bottom: 2px solid var(--form-warp-light-green); padding-bottom: 0.5rem; margin-bottom: 1rem; font-size: 1.5em; }
        .form-label { font-weight: 600; color: var(--form-warp-dark-gray); margin-bottom: 0.25rem; display: block; }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 0.5rem; border: 1px solid var(--form-warp-light-gray); border-radius: 0.375rem; margin-bottom: 0.75rem; box-sizing: border-box; color: var(--form-warp-dark-gray); }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--form-warp-light-green); box-shadow: 0 0 0 2px rgba(123, 201, 111, 0.5); }
        .radio-group label, .checkbox-group label { margin-right: 1rem; color: var(--form-warp-dark-gray); display: flex; align-items: center; margin-bottom: 0.25rem; }
        .radio-group input[type="radio"], .checkbox-group input[type="checkbox"] { margin-right: 0.5rem; accent-color: var(--form-warp-green); }
        .conditional-text { font-size: 0.875rem; color: var(--form-warp-dark-gray); margin-left: 0; padding-left: 1.5rem; }
        .page-indicator { font-size: 0.9rem; color: var(--form-warp-dark-gray); text-align: right; margin-bottom: 1rem;}
        .input-group { margin-bottom: 1rem; }
        .input-group > div:not(.checkbox-group):not(.radio-group):not(.flex) { margin-bottom: 0.5rem; }
        .hidden-field { display: none !important; }
        .form-select-small { width: auto; min-width: 100px; }

        .modal { display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 600px; border-radius: 0.5rem; position: relative; }
        .modal-close { color: #aaa; position: absolute; right: 15px; top: 10px; font-size: 28px; font-weight: bold; cursor: pointer; line-height: 1; }
        .modal-close:hover, .modal-close:focus { color: black; text-decoration: none; }
        .loading-spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--form-warp-green); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .gemini-button, .action-button { background-color: var(--form-warp-light-green); color: var(--form-warp-dun); padding: 0.4rem 0.8rem; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; margin-left: 0.5rem; border: 1px solid var(--form-warp-green); }
        .gemini-button:hover, .action-button:hover { background-color: var(--form-warp-green); color: white; }
        
        @media print {
            body { margin: 0 !important; padding: 0 !important; padding-top: 0 !important; font-size: 10pt; background-color: white !important; }
            header#warp-main-header { display: none !important; }
            .speetcheck-form-page-content { padding: 0 !important; }
            #formElementContainer { margin: 0.25in !important; padding: 0 !important; box-shadow: none !important; border-radius: 0 !important; max-width: 100% !important; border: none !important; }
            .no-print, .no-print * { display: none !important; }
            .form-input, .form-select, .form-textarea { border: 1px solid #ccc !important; background-color: #fdfdfd !important; }
            .section-title { font-size: 1.2em; border-bottom: 1px solid var(--form-warp-light-green); }
            .page-indicator { display: none !important; }
            .grid { display: block !important; } 
            .grid > * { margin-bottom: 0.5rem !important; }
        }
        .pdf-value-display::after { content: attr(data-pdf-value); display: block; border: 1px solid #eee; padding: 0.5rem; background-color: #f9f9f9; margin-top: 0.1rem; margin-bottom: 0.75rem; white-space: pre-wrap; font-family: 'Inter', sans-serif; font-size: 10pt; }
        input.pdf-value-display, select.pdf-value-display, textarea.pdf-value-display { display: none !important; }
    </style>
</head>
<body>
    <header id="warp-main-header">
        <div class="top-header">
            <div class="header-container">
                <div>
                    <a href="index.html" class="showroom-link mr-40"> 
                        <span>✓</span> Maak een showroomafspraak!
                    </a>
                </div>
                <div class="top-header-right">
                    <div class="search-container hidden md:block ml-60">
                        <input type="text" placeholder="Zoeken" class="w-46">
                        <span class="search-icon">⌕</span>
                    </div>
                    <a href="#" class="icon-placeholder-link" title="Favorieten">♡</a>
                    <a href="#" class="icon-placeholder-link" title="Winkelwagen">🛒</a>
                    <a href="#" class="offerte-button-top">SpeeTcheck</a> 
                </div>
            </div>
        </div>
        <div class="bottom-header">
            <div class="header-container">
                <nav class="centered-nav">
                    <a href="index.html#oplossingen" class="main-link">Onze oplossingen</a> 
                    <a href="index.html#systemen" class="main-link">Systemen</a>
                    <a href="index.html#aanleggen" class="main-link">Aanleggen</a>
                    <a href="index.html#webshop" class="main-link">Webshop</a>
                    <a href="index.html#zakelijk" class="main-link">WARP Zakelijk</a>
                    <a href="index.html#downloads" class="secondary-link">Downloads</a>
                    <a href="index.html#referenties" class="secondary-link">Referenties</a>
                    <a href="index.html#overons" class="secondary-link">Over ons</a>
                    <a href="index.html#werkenbij" class="secondary-link">Werken bij WARP</a>
                </nav>
                 <div class="hamburger-menu">
                     <button type="button">☰</button>
                 </div>
            </div>
        </div>
         <div id="logo-container">
             <img src="https://placehold.co/120x60/43ab34/ffffff?text=LOGO" alt="WARP Systems Logo" onerror="this.onerror=null;this.src='https://placehold.co/120x60/cccccc/000000?text=Logo+Error';">
        </div>
    </header>

    <main class="speetcheck-form-page-content">
        <div id="formElementContainer"> 
            <header class="mb-8">
                <div class="flex justify-between items-center mb-2">
                    <h1 class="text-4xl font-bold" style="color: var(--form-warp-green);">SpeeTcheck</h1>
                    <div class="text-right">
                        <p class="text-xl font-semibold" style="color: var(--form-warp-green);">WARP</p>
                        <p class="text-sm" style="color: var(--form-warp-dark-gray);">SYSTEMS</p>
                        <p class="text-xs" style="color: var(--form-warp-dark-gray);">VLOERVERWARMING</p>
                    </div>
                </div>
                <div class="p-3 rounded-md text-center" style="background-color: var(--form-warp-green); color: white;"> <h2 class="text-2xl font-semibold">Locatiebezoek</h2>
                </div>
            </header>

            <form id="speetcheckForm">
                <section id="page1" class="mb-10">
                    <div class="page-indicator">1/5</div>
                    <h3 class="section-title">Gegevens</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="klant_naam" class="form-label">Naam Klant</label>
                            <input type="text" id="klant_naam" name="klant_naam" class="form-input">
                            <label for="klant_adres" class="form-label mt-4">Adres Klant</label>
                            <input type="text" id="klant_adres" name="klant_adres" class="form-input">
                            <label for="klant_telefoon" class="form-label mt-4">Telefoonnummer Klant</label>
                            <input type="tel" id="klant_telefoon" name="klant_telefoon" class="form-input">
                        </div>
                        <div>
                            <label for="adviseur_naam" class="form-label">Naam Technisch Adviseur</label>
                            <input type="text" id="adviseur_naam" name="adviseur_naam" class="form-input">
                            <label for="adviseur_telefoon" class="form-label mt-4">Telefoonnummer Technisch Adviseur</label>
                            <input type="tel" id="adviseur_telefoon" name="adviseur_telefoon" class="form-input">
                            <label for="projectnummer" class="form-label mt-4">Projectnummer</label>
                            <input type="text" id="projectnummer" name="projectnummer" class="form-input">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                         <div>
                            <label for="installatiedatum" class="form-label">Installatiedatum</label>
                            <input type="date" id="installatiedatum" name="installatiedatum" class="form-input">
                        </div>
                        <div>
                            <label for="datum_locatiebezoek" class="form-label">Datum locatiebezoek</label>
                            <input type="date" id="datum_locatiebezoek" name="datum_locatiebezoek" class="form-input">
                        </div>
                    </div>
    
                    <h3 class="section-title">Checklist WARP Systems technisch adviseur</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 mb-6">
                        <div>
                            <label class="form-label">Systeem</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="systeem_speetile10" value="SpeeTile10 (±15mm)"> SpeeTile10 (±15mm)</label>
                                <label><input type="checkbox" name="systeem_speetherm15" value="SpeeTherm15 (15mm)"> SpeeTherm15 (15mm)</label>
                                <label><input type="checkbox" name="systeem_speetile12" value="SpeeTile12 (n.v.t.)"> SpeeTile12 (n.v.t.)</label>
                                <label><input type="checkbox" name="systeem_speetherm30" value="SpeeTherm30 (30mm)"> SpeeTherm30 (30mm)</label>
                                <label><input type="checkbox" name="systeem_evo" value="EVO"> EVO</label>
                            </div>
                        </div>
                        <div>
                            <label class="form-label">Oppervlakte (locatie)</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ondervloer_type_vloer" value="Vloer"> Vloer</label>
                                <label><input type="checkbox" name="ondervloer_type_wand" value="Wand"> Wand</label>
                                <label><input type="checkbox" name="ondervloer_type_plafond" value="Plafond"> Plafond</label>
                            </div>
                        </div>
                         <div>
                            <label class="form-label">Ondervloer (materiaal)</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="ondervloer_materiaal_hout" value="Hout"> Hout</label>
                                <label><input type="checkbox" name="ondervloer_materiaal_beton" value="Beton/zandcement"> Beton/zandcement</label>
                                <label><input type="checkbox" name="ondervloer_materiaal_isolatie" value="Isolatie"> Isolatie</label>
                                <label><input type="checkbox" name="ondervloer_materiaal_tegels" value="Tegels"> Tegels</label>
                                <label><input type="checkbox" name="ondervloer_materiaal_anders" value="Anders"> Anders</label>
                                <input type="text" id="ondervloer_materiaal_anders_details" name="ondervloer_materiaal_anders_details" class="form-input mt-1 hidden-field" placeholder="Specificatie 'Anders'">
                            </div>
                        </div>
                    </div>
    
                    <div class="input-group">
                        <label class="form-label">Wordt er gebruik gemaakt van de stortservice van WARP Systems?</label>
                        <select id="stortservice" name="stortservice" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                            <option value="nvt">N.V.T.</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er water met minimaal 1 bar druk beschikbaar voor de vulmassapomp (SpeeTile) en het vullen van de verdeler?</label>
                        <select name="water_beschikbaar" id="water_beschikbaar" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="water_beschikbaar_details" id="water_beschikbaar_details" class="form-input mt-1 hidden-field" placeholder="Ja, locatie: / Nee, afspraak:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er stroom aanwezig voor het mengen van de vulmassa? (16 ampère/230 Volt)</label>
                         <select id="stroom_aanwezig" name="stroom_aanwezig" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                            <option value="nvt">N.V.T.</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is/zijn de ruimte(s) geïsoleerd?</label>
                        <select name="ruimte_geisoleerd" id="ruimte_geisoleerd" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <div id="ruimte_geisoleerd_details_container" class="mt-2 hidden-field">
                            <label for="ruimte_geisoleerd_met" class="form-label">Ja, met:</label>
                            <input type="text" id="ruimte_geisoleerd_met" name="ruimte_geisoleerd_met" class="form-input mb-2" placeholder="Materiaal">
                            <label for="ruimte_geisoleerd_locatie_opp" class="form-label">Welke locatie/oppervlakte (isolatie)</label>
                            <input type="text" id="ruimte_geisoleerd_locatie_opp" name="ruimte_geisoleerd_locatie_opp" class="form-input">
                            <label for="ruimte_geisoleerd_energielabel" class="form-label mt-2">Energielabel</label>
                            <input type="text" id="ruimte_geisoleerd_energielabel" name="ruimte_geisoleerd_energielabel" class="form-input" placeholder="Kies energielabel">
                            <label for="ruimte_geisoleerd_m2_systeem" class="form-label mt-2">Aantal m² systeem</label>
                            <input type="number" id="ruimte_geisoleerd_m2_systeem" name="ruimte_geisoleerd_m2_systeem" class="form-input">
                            <label for="ruimte_geisoleerd_m2_speetube" class="form-label mt-2">Aantal m² SpeeTube</label>
                            <input type="number" id="ruimte_geisoleerd_m2_speetube" name="ruimte_geisoleerd_m2_speetube" class="form-input">
                            <label for="ruimte_geisoleerd_m2_storten" class="form-label mt-2">Aantal m² storten</label>
                            <input type="number" id="ruimte_geisoleerd_m2_storten" name="ruimte_geisoleerd_m2_storten" class="form-input">
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er niveauverschil in de woning en/of sprake van een opstap/verhoging?</label>
                        <select name="niveauverschil" id="niveauverschil" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="niveauverschil_waar" id="niveauverschil_waar" class="form-input mt-1 hidden-field" placeholder="Ja, waar:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Valt de vloer binnen vlakheidsklasse 1? (NEN 2747), 2mm/m²</label>
                        <select name="vlakheidsklasse" id="vlakheidsklasse" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja, vastgesteld aan de hand van grid meting</option>
                            <option value="nee">Nee, risico op niet volledige dekking van het SpeeTile systeem</option>
                        </select>
                    </div>
                </section>
    
                <section id="page2" class="mb-10">
                    <div class="page-indicator">2/5</div>
                    <h3 class="section-title">Locatiebezoek (Vervolg)</h3>
                    <div class="input-group">
                        <label class="form-label">Bevat de woning oneffenheden zoals hobbels en/of kuilen?</label>
                         <select name="oneffenheden" id="oneffenheden" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja, risico op niet volledige dekking van het SpeeTile systeem</option>
                            <option value="nee">Nee</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Wat is de staat van de ondervloer?</label>
                        <div class="mb-2">
                            <label for="staat_ondervloer_lijmresten" class="form-label text-sm">Bevat lijmresten en gipsresten?</label>
                            <select name="staat_ondervloer_lijmresten" id="staat_ondervloer_lijmresten" class="form-select form-select-small">
                                <option value="">Kies...</option><option value="ja">Ja</option><option value="nee">Nee</option>
                            </select>
                        </div>
                        <div class="mb-2">
                            <label for="staat_ondervloer_vet" class="form-label text-sm">Is de vloer vet?</label>
                            <select name="staat_ondervloer_vet" id="staat_ondervloer_vet" class="form-select form-select-small">
                                <option value="">Kies...</option><option value="ja">Ja</option><option value="nee">Nee</option>
                            </select>
                        </div>
                        <div>
                            <label for="staat_ondervloer_hol" class="form-label text-sm">Klinkt de vloer hol?</label>
                            <select name="staat_ondervloer_hol" id="staat_ondervloer_hol" class="form-select form-select-small">
                                <option value="">Kies...</option><option value="ja">Ja</option><option value="nee">Nee</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is de ondervloer glad? (ondervloer mag niet golven)</label>
                        <select name="ondervloer_glad" id="ondervloer_glad" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="ondervloer_glad_maatregelen" id="ondervloer_glad_maatregelen" class="form-input mt-1 hidden-field" placeholder="Nee, maatregelen klant:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is de ondervloer stabiel? (ter beoordeling door technisch adviseur)</label>
                        <select name="ondervloer_stabiel" id="ondervloer_stabiel" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="ondervloer_stabiel_maatregelen" id="ondervloer_stabiel_maatregelen" class="form-input mt-1 hidden-field" placeholder="Nee, maatregelen klant:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Welke afwerking wordt over het systeem geplaatst?</label>
                        <select id="afwerking_systeem" name="afwerking_systeem" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="flexibel_zwevend">Flexibel zwevend</option>
                            <option value="stijf_zwevend">Stijf zwevend</option>
                            <option value="flexibel_verlijmd">Flexibel verlijmd (bij SpeeTherm altijd i.c.m. Jumpax basic)</option>
                            <option value="gietvloer">Gietvloer</option>
                            <option value="stijf_verlijmd">Stijf verlijmd</option>
                            <option value="onbekend">Nog onbekend</option>
                        </select>
                        <p class="conditional-text mt-2">LET OP! Vulmassa (SpeeTop) is ongeschikt om direct af te werken met de gekozen afwerking. De vloer dient te allen tijde gecontroleerd te worden door de applicateur op mogelijke na-egalisatie!</p>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Wordt er naderhand een plint verwerkt?</label>
                        <select id="plint_verwerkt" name="plint_verwerkt" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="nee">Nee</option>
                            <option value="ja_wand">Ja, op de wand</option>
                            <option value="ja_vloer">Ja, op de vloer</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Zijn de muren bij installatie al afgewerkt? (SpeeTile)</label>
                        <select name="muren_afgewerkt" id="muren_afgewerkt" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <p id="muren_afgewerkt_risico" class="conditional-text mt-1 hidden-field">Er is risico op schade door plakrand randisolatie.</p>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Moet WARP Systems de wanden afplakken?</label>
                         <select name="wanden_afplakken" id="wanden_afplakken" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <p id="wanden_afplakken_risico" class="conditional-text mt-1 hidden-field">Er is risico op verfschade door tape.</p>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er een kruipluik aanwezig in het te installeren oppervlak?</label>
                        <select name="kruipluik_aanwezig" id="kruipluik_aanwezig" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <p id="kruipluik_instructie" class="conditional-text mt-1 hidden-field">De klant dient rondom het kruipluik waterdichte latten van 3cm hoog te plaatsen en af te kitten (met acrylaatkit).</p>
                    </div>
                </section>
    
                <section id="page3" class="mb-10">
                    <div class="page-indicator">3/5</div>
                    <h3 class="section-title">Technische Specificaties</h3>
                    <div class="input-group">
                        <label class="form-label">Soort primaire warmtebron</label>
                        <select id="warmtebron" name="warmtebron" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="cv_ketel">CV-Ketel</option>
                            <option value="warmtepomp">Warmtepomp</option>
                            <option value="hybride_warmtepomp">Hybride warmtepomp</option>
                            <option value="toekomstige_warmtepomp">Toekomstige (hybride) warmtepomp</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="beoogde_groepslengte" class="form-label">Beoogde groepslengte</label>
                        <input type="text" id="beoogde_groepslengte" name="beoogde_groepslengte" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er zoneregeling van toepassing?</label>
                        <select name="zoneregeling" id="zoneregeling" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="number" name="zoneregeling_aantal" id="zoneregeling_aantal" class="form-input mt-1 hidden-field" placeholder="Aantal zones:">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="aantal_groepen" class="form-label">Aantal groepen</label>
                            <input type="number" id="aantal_groepen" name="aantal_groepen" class="form-input">
                        </div>
                        <div>
                            <label for="aantal_aansluitingen" class="form-label">Aantal aansluitingen</label>
                            <input type="number" id="aantal_aansluitingen" name="aantal_aansluitingen" class="form-input">
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Verdelerkast (afmetingen)</label>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                            <div>
                                <label for="verdeler_locatie" class="form-label text-sm">Locatie</label>
                                <input type="text" id="verdeler_locatie" name="verdeler_locatie" class="form-input">
                            </div>
                            <div>
                                <label for="verdeler_lengte" class="form-label text-sm">Lengte (mm)</label>
                                <input type="number" id="verdeler_lengte" name="verdeler_lengte" class="form-input">
                            </div>
                            <div>
                                <label for="verdeler_hoogte" class="form-label text-sm">Hoogte (mm)</label>
                                <input type="number" id="verdeler_hoogte" name="verdeler_hoogte" class="form-input">
                            </div>
                            <div>
                                <label for="verdeler_diepte" class="form-label text-sm">Diepte (mm)</label>
                                <input type="number" id="verdeler_diepte" name="verdeler_diepte" class="form-input">
                            </div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is de wand geschikt voor het plaatsen van de verdeler?</label>
                        <select name="wand_geschikt_verdeler" id="wand_geschikt_verdeler" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <p id="wand_geschikt_verdeler_instructie" class="conditional-text mt-1 hidden-field">Klant moet houten platen bevestigen van >18mm dik. Breedte en lengte a.d.h.v. de verdeler grootte (inclusief pompunit).</p>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Welke diameter moet de primaire aansluiting minimaal zijn? (Let op dit is geen bindend advies)</label>
                        <select id="diameter_aansluiting" name="diameter_aansluiting" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="ht_15_20_lt7">HT = 15mm staal/20mm flex (verdeler &lt;7gr)</option>
                            <option value="lt_20_26_lt7">LT = 20mm staal/26mm flex (verdeler &lt;7gr)</option>
                            <option value="ht_20_26_gt7">HT = 20mm staal/26mm flex (verdeler &gt;7gr)</option>
                            <option value="lt_25_32_gt7">LT = 25mm staal/32mm flex (verdeler &gt;7gr)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Locatie primaire aansluitingen?</label>
                        <div class="radio-group flex flex-wrap">
                            <label><input type="radio" name="locatie_primair" value="lb"> LB</label>
                            <label><input type="radio" name="locatie_primair" value="rb"> RB</label>
                            <label><input type="radio" name="locatie_primair" value="lo"> LO</label>
                            <label><input type="radio" name="locatie_primair" value="ro"> RO</label>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is het een kelderinstallatie?</label>
                        <select id="kelderinstallatie" name="kelderinstallatie" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="nee">Nee</option>
                            <option value="ja">Ja</option>
                            <option value="ja_pomp_draaien">Ja, pomp 180 graden draaien</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Moet de klant een stopcontact voorbereiden?</label>
                        <select id="stopcontact_voorbereiden" name="stopcontact_voorbereiden" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="nee">Nee</option>
                            <option value="ja">Ja</option>
                            <option value="ja_bij_verdeler">Ja, bij de verdeler</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Moeten er één of meerdere groepen SpeeTube door de muur/wand?</label>
                        <select name="speetube_door_muur" id="speetube_door_muur" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="speetube_door_muur_details" id="speetube_door_muur_details" class="form-input mt-1 hidden-field" placeholder="Ja, klant dient doorvoer voor te bereiden:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Hangt de klant zelf de verdeler op?</label>
                        <select name="klant_hangt_verdeler" id="klant_hangt_verdeler" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <p id="klant_hangt_verdeler_instructie" class="conditional-text mt-1 hidden-field">De verdeler dient op minimaal 30cm hoogte (onderste punt) van de vloer opgehangen te worden.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="input-group">
                            <label class="form-label">In welk soort woning wordt het systeem geïnstalleerd?</label>
                            <select name="soort_woning" id="soort_woning" class="form-select">
                                <option value="">Kies een optie</option>
                                <option value="appartement">Appartement</option>
                                <option value="woonhuis">Woonhuis</option>
                                <option value="anders">Anders</option>
                            </select>
                            <input type="text" name="soort_woning_anders" id="soort_woning_anders" class="form-input mt-1 hidden-field" placeholder="Anders, specificatie:">
                        </div>
                        <div class="input-group">
                            <label class="form-label">Op welke verdieping wordt het systeem geïnstalleerd?</label>
                            <select name="verdieping_installatie" id="verdieping_installatie" class="form-select">
                                <option value="">Kies een optie</option>
                                <option value="begane_grond">Begane grond</option>
                                <option value="eerste_verdieping">Eerste verdieping</option>
                                <option value="tweede_verdieping">Tweede verdieping</option>
                                <option value="anders">Anders</option>
                            </select>
                            <input type="text" name="verdieping_installatie_anders" id="verdieping_installatie_anders" class="form-input mt-1 hidden-field" placeholder="Anders, specificatie:">
                        </div>
                    </div>
                </section>
    
                <section id="page4" class="mb-10">
                    <div class="page-indicator">4/5</div>
                    <h3 class="section-title">Logistiek en Veiligheid</h3>
                    <div class="input-group">
                        <label class="form-label">Is er een lift aanwezig? (min. 650kg & 90x140cm)</label>
                        <select name="lift_aanwezig" id="lift_aanwezig" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="nvt">N.V.T.</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="lift_aanwezig_afspraken" id="lift_aanwezig_afspraken" class="form-input mt-1 hidden-field" placeholder="Nee, afspraken:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Moet er op meer dan 1 meter hoogte worden gewerkt?</label>
                        <select name="hoogte_werk" id="hoogte_werk" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="hoogte_werk_maatregelen" id="hoogte_werk_maatregelen" class="form-input mt-1 hidden-field" placeholder="Ja, maatregelen:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Moet er in verband met VCA extra op de veiligheid worden gelet?</label>
                        <select name="vca_veiligheid" id="vca_veiligheid" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="vca_veiligheid_omdat" id="vca_veiligheid_omdat" class="form-input mt-1 hidden-field" placeholder="Ja, omdat:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Waar kan het SpeeTeam vanaf 07:00 uur in de ochtend parkeren?</label>
                        <select id="parkeren_speeteam" name="parkeren_speeteam" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="oprit">Oprit (klant dient eventuele buren in te lichten over stof)</option>
                            <option value="straat">Straat parkeren (klant dient 2 plekken achter elkaar vrij te houden)</option>
                            <option value="binnenstad">Parkeren in binnensteden (klant moet vergunningen aanvragen of parkeerplekken reserveren)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is het mogelijk om de materialen één werkdag vóór de installatie te leveren?</label>
                        <select id="levering_materialen" name="levering_materialen" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee_dag_installatie">Nee, op de dag van installatie</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er speciaal transport nodig? (in overleg met logistiek)</label>
                        <select name="speciaal_transport" id="speciaal_transport" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                        <input type="text" name="speciaal_transport_details" id="speciaal_transport_details" class="form-input mt-1 hidden-field" placeholder="Ja, specificatie:">
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is er na het locatiebezoek nog extra informatie van de klant nodig?</label>
                        <select id="extra_informatie_klant" name="extra_informatie_klant" class="form-select">
                            <option value="">Kies een optie</option>
                            <option value="nee">Nee</option>
                            <option value="ja_2e_bezoek">Ja, 2e locatiebezoek</option>
                            <option value="ja_controlebezoek">Ja, controlebezoek</option>
                            <option value="ja_belafspraak">Ja, belafspraak nodig</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Zijn de installatievoorwaarden, het begrip aanneemsom en het opstookprotocol (SpeeTile) besproken en akkoord bevonden?</label>
                        <select id="voorwaarden_akkoord" name="voorwaarden_akkoord" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is de klant bekend met onze verplaatsings- en annuleringskosten?</label>
                         <select id="kosten_bekend" name="kosten_bekend" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="form-label">Is het bij de klant bekend dat een bevoegd persoon bij aanvang van de werkzaamheden en oplevering van het systeem aanwezig moet zijn?</label>
                        <select id="bevoegd_persoon_aanwezig" name="bevoegd_persoon_aanwezig" class="form-select form-select-small">
                            <option value="">Kies een optie</option>
                            <option value="ja">Ja</option>
                            <option value="nee">Nee</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <div class="flex items-center justify-between">
                            <label for="complexiteit_project" class="form-label mb-0">Complexiteit van het project</label>
                            <button type="button" id="analyzeComplexityBtn" class="gemini-button no-print">✨ Analyseer Complexiteit & Risico's</button>
                        </div>
                        <textarea id="complexiteit_project" name="complexiteit_project" rows="4" class="form-textarea mt-2"></textarea>
                        <div id="complexityLoading" class="loading-spinner hidden-field no-print" style="width: 20px; height: 20px; margin-top: 5px;"></div>
                    </div>
                </section>
    
                <section id="page5" class="mb-10">
                    <div class="page-indicator">5/5</div>
                    <h3 class="section-title">Voorbereiding en Akkoord</h3>
                    <div class="input-group">
                        <div class="flex items-center justify-between mb-2">
                            <label class="form-label mb-0">Samenvatting voorbereiding voor de klant:</label>
                            <button type="button" id="generateAdviceBtn" class="gemini-button no-print">✨ Genereer Voorbereidingsadvies</button>
                        </div>
                        <p class="text-xs text-gray-500 mb-2">(De klant dient zelf de voorbereidingen te treffen)</p>
                        <div>
                            <label for="voorbereiding_latten" class="form-label text-sm">Latten:</label>
                            <input type="text" id="voorbereiding_latten" name="voorbereiding_latten" class="form-input">
                        </div>
                        <div>
                            <label for="voorbereiding_doorvoeren" class="form-label text-sm">Doorvoeren:</label>
                            <input type="text" id="voorbereiding_doorvoeren" name="voorbereiding_doorvoeren" class="form-input">
                        </div>
                        <div>
                            <label for="voorbereiding_afplakken" class="form-label text-sm">Afplakken:</label>
                            <input type="text" id="voorbereiding_afplakken" name="voorbereiding_afplakken" class="form-input">
                        </div>
                        <div>
                            <label for="voorbereiding_uitvlakken" class="form-label text-sm">Uitvlakken:</label>
                            <input type="text" id="voorbereiding_uitvlakken" name="voorbereiding_uitvlakken" class="form-input">
                        </div>
                        <div>
                            <label for="voorbereiding_verwijderen" class="form-label text-sm">Verwijderen:</label>
                            <input type="text" id="voorbereiding_verwijderen" name="voorbereiding_verwijderen" class="form-input">
                        </div>
                    </div>
    
                    <div class="input-group">
                        <label class="form-label">Checklist voor jou als klant</label>
                        <p class="text-sm text-gray-600 mb-2">Vóór aanvang en start van de installatie zullen onderstaande punten moeten zijn uitgevoerd:</p>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="checklist_klant_leeg_schoon"> De desbetreffende ruimte(s) zijn leeg, schoon en stofvrij</label>
                            <label><input type="checkbox" name="checklist_klant_geen_tocht"> In de desbetreffende ruimte(s) is geen tocht aanwezig (SpeeTile systeem)</label>
                            <label><input type="checkbox" name="checklist_klant_geen_zoninval"> In de desbetreffende ruimte(s) is geen zoninval aanwezig (SpeeTile systeem)</label>
                            <label><input type="checkbox" name="checklist_klant_barrierres"> Op plaatsen waar geen vulmassa mag komen zijn barrières (latten) geplaatst van minimaal 3cm hoog (SpeeTile systeem) en afgekit (met acrylaatkit)</label>
                            <label><input type="checkbox" name="checklist_klant_markering"> Plaatsen waar geen SpeeTube verwarmingsbuis, maar wel vulmassa moet komen zijn gemarkeerd met tape (SpeeTile)</label>
                            <label><input type="checkbox" name="checklist_klant_vorst"> Bij vorst dient de ruimte verwarmd te worden tot een binnentemperatuur van minimaal 15°C voor de verwerking van de vulmassa (SpeeTile)</label>
                        </div>
                    </div>
                    <div class="input-group mt-8">
                        <p class="text-sm text-gray-700">Hierbij verklaren klant en ondergetekende, namens WARP Systems, dat dit formulier volledig is besproken, doorgenomen en akkoord is. De ondertekening van dit formulier geldt uitsluitend als bevestiging van bovenstaande en impliceert geen akkoord op de offerte.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                        <div>
                            <label for="handtekening_klant" class="form-label">Handtekening Klant (naam invullen)</label>
                            <input type="text" id="handtekening_klant" name="handtekening_klant" class="form-input" placeholder="Volledige naam klant">
                        </div>
                        <div>
                            <label for="handtekening_adviseur" class="form-label">Handtekening Technisch Adviseur WARP Systems (naam invullen)</label>
                            <input type="text" id="handtekening_adviseur" name="handtekening_adviseur" class="form-input" placeholder="Volledige naam adviseur">
                        </div>
                    </div>
                </section>
    
                <div class="mt-10 text-center no-print">
                    <button type="submit" id="saveConceptBtn" class="px-6 py-3 rounded-lg text-white font-semibold hover:opacity-90 transition-opacity" style="background-color: var(--form-warp-green);">Formulier Opslaan (Concept)</button>
                    <button type="button" id="saveAsPdfBtn" class="px-6 py-3 rounded-lg text-white font-semibold hover:opacity-90 transition-opacity action-button" style="background-color: var(--form-warp-dark-gray); margin-left: 10px;">Opslaan als PDF</button>
                    <p class="text-xs text-gray-500 mt-2">(Opslaan als concept vereist backend-functionaliteit; PDF wordt lokaal gegenereerd)</p>
                </div>
            </form>

            <footer class="mt-12 pt-8 border-t border-gray-300">
                <p class="text-center text-sm" style="color: var(--form-warp-dark-gray);">F.03 SpeeTcheck 2024 V1.6 &nbsp;&nbsp;&nbsp; <a href="https://www.warp-systems.nl" target="_blank" class="hover:underline" style="color: var(--form-warp-green);">www.warp-systems.nl</a></p>
                <div class="footer-bar mt-4 rounded-md overflow-hidden">
                    <div class="footer-segment" style="background-color: var(--form-warp-dun);">DUN</div>
                    <div class="footer-segment" style="background-color: var(--form-warp-light-green);">SNEL</div>
                    <div class="footer-segment" style="background-color: var(--form-warp-light-gray); color: var(--form-warp-dark-gray);">LICHT</div>
                    <div class="footer-segment" style="background-color: var(--form-warp-green);">WATER</div>
                    <div class="footer-segment" style="background-color: var(--form-warp-green);">DUURZAAM</div>
                </div>
            </footer>
        </div> 
        
        <div id="geminiModal" class="modal no-print">
            <div class="modal-content">
                <span class="modal-close" id="modalCloseBtn">&times;</span>
                <h3 id="modalTitle" class="text-xl font-semibold mb-4" style="color: var(--form-warp-green);"> gegenereerd advies</h3>
                <div id="modalBody">
                    <div id="modalLoading" class="loading-spinner"></div>
                    <p id="modalError" class="text-red-600 hidden-field"></p>
                    <div id="modalResultText" class="text-sm text-gray-700 whitespace-pre-wrap"></div>
                </div>
                <div class="mt-6 text-right">
                    <button id="copyToClipboardBtn" class="gemini-button hidden-field">Kopieer naar Klembord</button>
                </div>
            </div>
        </div>
    </main>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const hamburgerButton = document.querySelector('#warp-main-header .hamburger-menu button');
        const centeredNav = document.querySelector('#warp-main-header nav.centered-nav');

        if (hamburgerButton && centeredNav) {
            hamburgerButton.addEventListener('click', () => {
                alert("Hamburgermenu geklikt - Navigatie-toggle logica hier implementeren.");
            });
        }

        function toggleField(selectElementId, targetElementId, showValue) {
            const selectElement = document.getElementById(selectElementId);
            const targetElement = document.getElementById(targetElementId);
            if (selectElement && targetElement) {
                const handleChange = function() {
                    if (this.value === showValue) {
                        targetElement.classList.remove('hidden-field');
                        const firstInput = targetElement.querySelector('input, textarea, select');
                        if (firstInput && firstInput.focus) { firstInput.focus(); } 
                        else if (targetElement.focus) { targetElement.focus(); }
                    } else {
                        if (!targetElement.hasAttribute('data-always-show')) {
                             targetElement.classList.add('hidden-field');
                        }
                    }
                };
                selectElement.addEventListener('change', handleChange);
                handleChange.call(selectElement); 
            }
        }
        
        function toggleFieldByCheckbox(checkboxName, targetElementId) {
            const checkbox = document.querySelector(`input[name="${checkboxName}"]`);
            const targetElement = document.getElementById(targetElementId);
            if (checkbox && targetElement) {
                const handleChange = function() {
                    if (this.checked) {
                        targetElement.classList.remove('hidden-field');
                        if (targetElement.focus) targetElement.focus();
                    } else {
                        targetElement.classList.add('hidden-field');
                        targetElement.value = ''; 
                    }
                };
                checkbox.addEventListener('change', handleChange);
                handleChange.call(checkbox);
            }
        }

        toggleFieldByCheckbox('ondervloer_materiaal_anders', 'ondervloer_materiaal_anders_details');
        
        const waterBeschikbaarSelect = document.getElementById('water_beschikbaar');
        const waterBeschikbaarDetails = document.getElementById('water_beschikbaar_details');
        if (waterBeschikbaarSelect && waterBeschikbaarDetails) {
            const handleWaterChange = function() {
                if (this.value === 'ja' || this.value === 'nee') {
                    waterBeschikbaarDetails.classList.remove('hidden-field');
                    waterBeschikbaarDetails.placeholder = this.value === 'ja' ? 'Ja, locatie:' : 'Nee, afspraak:';
                } else {
                    waterBeschikbaarDetails.classList.add('hidden-field');
                }
            };
            waterBeschikbaarSelect.addEventListener('change', handleWaterChange);
            handleWaterChange.call(waterBeschikbaarSelect);
        }

        toggleField('ruimte_geisoleerd', 'ruimte_geisoleerd_details_container', 'ja');
        toggleField('niveauverschil', 'niveauverschil_waar', 'ja');
        toggleField('ondervloer_glad', 'ondervloer_glad_maatregelen', 'nee');
        toggleField('ondervloer_stabiel', 'ondervloer_stabiel_maatregelen', 'nee');
        toggleField('muren_afgewerkt', 'muren_afgewerkt_risico', 'ja');
        toggleField('wanden_afplakken', 'wanden_afplakken_risico', 'ja');
        toggleField('kruipluik_aanwezig', 'kruipluik_instructie', 'ja');
        toggleField('zoneregeling', 'zoneregeling_aantal', 'ja');
        toggleField('wand_geschikt_verdeler', 'wand_geschikt_verdeler_instructie', 'nee');
        toggleField('speetube_door_muur', 'speetube_door_muur_details', 'ja');
        toggleField('klant_hangt_verdeler', 'klant_hangt_verdeler_instructie', 'ja');
        toggleField('soort_woning', 'soort_woning_anders', 'anders');
        toggleField('verdieping_installatie', 'verdieping_installatie_anders', 'anders');
        toggleField('lift_aanwezig', 'lift_aanwezig_afspraken', 'nee');
        toggleField('hoogte_werk', 'hoogte_werk_maatregelen', 'ja');
        toggleField('vca_veiligheid', 'vca_veiligheid_omdat', 'ja');
        toggleField('speciaal_transport', 'speciaal_transport_details', 'ja');
        
        const saveConceptBtn = document.getElementById('saveConceptBtn');
        if (saveConceptBtn) {
            saveConceptBtn.addEventListener('click', function(event) {
                event.preventDefault(); 
                showModalMessage('Formulier Opslaan (Concept) is een placeholder. Voor daadwerkelijke opslag is server-functionaliteit nodig.', 'Formulier Status', 4000);
            });
        }
        
        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;

        const modal = document.getElementById('geminiModal');
        const modalCloseBtn = document.getElementById('modalCloseBtn');
        const modalTitle = document.getElementById('modalTitle');
        const modalLoading = document.getElementById('modalLoading');
        const modalError = document.getElementById('modalError');
        const modalResultText = document.getElementById('modalResultText');
        const copyToClipboardBtn = document.getElementById('copyToClipboardBtn');

        function showModal(title = "Resultaat") {
            if (!modal) return;
            modalTitle.textContent = title;
            if(modalLoading) modalLoading.style.display = 'block';
            if(modalError) modalError.classList.add('hidden-field');
            if(modalResultText) modalResultText.textContent = '';
            if(copyToClipboardBtn) copyToClipboardBtn.classList.add('hidden-field');
            modal.style.display = 'block';
        }

        function closeModal() {
            if (!modal) return;
            modal.style.display = 'none';
        }

        if(modalCloseBtn) modalCloseBtn.onclick = closeModal;
        window.onclick = function(event) {
            if (event.target == modal) {
                closeModal();
            }
        }
        
        if(copyToClipboardBtn) {
            copyToClipboardBtn.onclick = function() {
                const textToCopy = modalResultText.textContent;
                if (textToCopy) {
                    const textArea = document.createElement("textarea");
                    textArea.value = textToCopy;
                    document.body.appendChild(textArea);
                    textArea.select();
                    try {
                        document.execCommand('copy');
                        showModalMessage("Tekst gekopieerd!", "Status", 2000);
                    } catch (err) {
                        showModalMessage("Kopiëren mislukt.", "Fout", 3000);
                    }
                    document.body.removeChild(textArea);
                }
            }
        }

        function showModalMessage(message, title, duration = null) {
            showModal(title);
            if(modalLoading) modalLoading.style.display = 'none';
            if(modalResultText) modalResultText.textContent = message;
            if (duration) {
                setTimeout(closeModal, duration);
            }
        }

        async function callGeminiAPI(prompt) {
            if (apiKey === "") {
                 console.warn("Gemini API key is niet ingesteld.");
                 return new Promise(resolve => {
                    setTimeout(() => {
                        resolve("Voorbeeld AI antwoord: API key niet ingesteld. Dit is een placeholder respons. Stel een API key in of gebruik een backend proxy. Focus op het schoonmaken van de ondervloer en controleer op losse delen.");
                    }, 1000);
                 });
            }
             const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) { const errorData = await response.json(); throw new Error(`API request failed: ${errorData.error?.message || response.statusText}`); }
                const result = await response.json();
                if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts) { return result.candidates[0].content.parts[0].text; } 
                else { throw new Error('Kon geen geldige tekst genereren van de API.'); }
            } catch (error) { console.error('Error calling Gemini API:', error); throw error; }
        }

        const generateAdviceBtn = document.getElementById('generateAdviceBtn');
        if (generateAdviceBtn) {
            generateAdviceBtn.addEventListener('click', async function() {
                showModal("Voorbereidingsadvies Genereren...");
                let promptText = "Genereer een gedetailleerde checklist met voorbereidingspunten voor een WARP Systems vloerverwarming installatie. Details:\n";
                // Vereenvoudigde data collectie voor demo
                promptText += `- Systeem: ${document.querySelector('input[name^="systeem_"]:checked') ? document.querySelector('input[name^="systeem_"]:checked').value : 'Niet gespecificeerd'}\n`;
                promptText += `- Ondervloer: ${document.querySelector('input[name^="ondervloer_materiaal_"]:checked') ? document.querySelector('input[name^="ondervloer_materiaal_"]:checked').value : 'Niet gespecificeerd'}\n`;
                promptText += `Geef duidelijke, actiegerichte punten voor de klant.`;
                
                try {
                    const advice = await callGeminiAPI(promptText);
                    if(modalLoading) modalLoading.style.display = 'none';
                    if(modalResultText) modalResultText.textContent = advice;
                    if(copyToClipboardBtn) copyToClipboardBtn.classList.remove('hidden-field');
                } catch (error) {
                    if(modalLoading) modalLoading.style.display = 'none';
                    if(modalError) { modalError.textContent = `Fout bij genereren: ${error.message}`; modalError.classList.remove('hidden-field');}
                }
            });
        }

        const analyzeComplexityBtn = document.getElementById('analyzeComplexityBtn');
        const complexiteitProjectTextarea = document.getElementById('complexiteit_project');
        const complexityLoadingSpinner = document.getElementById('complexityLoading');

        if (analyzeComplexityBtn && complexiteitProjectTextarea && complexityLoadingSpinner) {
            analyzeComplexityBtn.addEventListener('click', async function() {
                if(complexityLoadingSpinner) complexityLoadingSpinner.classList.remove('hidden-field');
                analyzeComplexityBtn.disabled = true;
                let promptText = "Analyseer complexiteit en risico's voor dit vloerverwarmingsproject. Details:\n";
                // Vereenvoudigde data collectie
                promptText += `- Oneffenheden: ${document.getElementById('oneffenheden') ? document.getElementById('oneffenheden').value : 'n.v.t.'}\n`;
                promptText += `- Staat ondervloer (lijm): ${document.getElementById('staat_ondervloer_lijmresten') ? document.getElementById('staat_ondervloer_lijmresten').value : 'n.v.t.'}\n`;
                promptText += `Geef een beknopte samenvatting en aandachtspunten.`;

                try {
                    const analysis = await callGeminiAPI(promptText);
                    const currentText = complexiteitProjectTextarea.value;
                    complexiteitProjectTextarea.value = currentText ? `${currentText}\n\n--- AI Analyse ---\n${analysis}` : analysis;
                } catch (error) {
                    const currentText = complexiteitProjectTextarea.value;
                    complexiteitProjectTextarea.value = currentText ? `${currentText}\n\n--- Fout bij AI Analyse ---\n${error.message}` : `Fout: ${error.message}`;
                } finally {
                    if(complexityLoadingSpinner) complexityLoadingSpinner.classList.add('hidden-field');
                    analyzeComplexityBtn.disabled = false;
                }
            });
        }

        const saveAsPdfBtn = document.getElementById('saveAsPdfBtn');
        if (saveAsPdfBtn) {
            saveAsPdfBtn.addEventListener('click', function() {
                const formElementForPdf = document.getElementById('formElementContainer'); 
                const projectNummerInput = document.getElementById('projectnummer');
                const projectNummer = projectNummerInput ? projectNummerInput.value || "onbekend" : "onbekend";
                const datum = new Date().toISOString().slice(0,10);
                const filename = `SpeeTcheck_WARP_Systems_${projectNummer}_${datum}.pdf`;

                const elementsToTransform = formElementForPdf.querySelectorAll('input[type="text"], input[type="tel"], input[type="date"], input[type="number"], input[type="email"], textarea, select');
                const originalDisplayValues = new Map();

                elementsToTransform.forEach(el => {
                    originalDisplayValues.set(el, el.style.display); 
                    let valueToDisplay = '';
                    if (el.tagName === 'SELECT') {
                        if (el.multiple) { valueToDisplay = Array.from(el.selectedOptions).map(opt => opt.text).join(', '); } 
                        else if (el.selectedIndex > -1 && el.options[el.selectedIndex]) { valueToDisplay = el.options[el.selectedIndex].text; }
                    } else if (el.type === 'checkbox' || el.type === 'radio') { return; } 
                    else { valueToDisplay = el.value; }
                    
                    if (valueToDisplay && valueToDisplay.trim() !== '' && valueToDisplay.trim() !== 'Kies een optie' && valueToDisplay.trim() !== 'Kies...') {
                        el.setAttribute('data-pdf-value', valueToDisplay);
                        el.classList.add('pdf-value-display'); 
                    }
                });

                var opt = {
                  margin: [0.4, 0.4, 0.4, 0.4], filename: filename, image: { type: 'jpeg', quality: 0.95 },
                  html2canvas:  { scale: 2, logging: false, useCORS: true, dpi: 192, letterRendering: true, scrollY: -window.scrollY },
                  jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                };
                
                const uiElementsToHide = formElementForPdf.querySelectorAll('.gemini-button, .action-button, #saveConceptBtn'); 
                uiElementsToHide.forEach(btn => btn.classList.add('no-print'));
                if(modal) modal.classList.add('no-print');

                html2pdf().from(formElementForPdf).set(opt).save().then(() => {
                    elementsToTransform.forEach(el => { el.removeAttribute('data-pdf-value'); el.classList.remove('pdf-value-display'); el.style.display = originalDisplayValues.get(el) || ''; });
                    uiElementsToHide.forEach(btn => btn.classList.remove('no-print'));
                    if(modal) modal.classList.remove('no-print');
                    showModalMessage('PDF succesvol gegenereerd!', 'PDF Status', 3000);
                }).catch(err => {
                     elementsToTransform.forEach(el => { el.removeAttribute('data-pdf-value'); el.classList.remove('pdf-value-display'); el.style.display = originalDisplayValues.get(el) || ''; });
                    uiElementsToHide.forEach(btn => btn.classList.remove('no-print'));
                    if(modal) modal.classList.remove('no-print');
                    showModalMessage('Fout bij PDF: ' + err.message, 'PDF Fout', 5000);
                    console.error("PDF error: ", err);
                });
            });
        }
    });
    </script>
</body>
</html>
